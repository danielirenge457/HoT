<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Posting System — Hope of Tomorrow</title>
        <link rel="stylesheet" href="assets/css/styles.css">
        <style>
            .hidden { display:none; }
        </style>
    </head>
    <body>
        <header class="site-header">
            <div class="container">
                <a class="brand" href="Home-Page.html"><img src="image/HoT.png" alt="Hope of Tomorrow Logo" class="logo"></a>
                <nav class="site-nav"><a href="Sign In-Sign Up.html">Sign In / Sign Up</a></nav>
            </div>
        </header>

        <main class="container">
            <h1>Hope of Tomorrow - Posts</h1>

            <div class="container hidden" id="postSection">
                <textarea id="postText" placeholder="Write your post here..." rows="4"></textarea>
                <input type="file" id="postImages" accept="image/*" multiple>
                <button class="btn-primary" onclick="submitPost()">Submit Post</button>
            </div>

            <div class="container">
                <div id="postsContainer"></div>
            </div>

            <div class="container hidden" id="managerSection">
                <h2>Manager Approvals</h2>
                <div id="managerPosts"></div>
            </div>
        </main>

<script>
// Simulated localStorage users and manager
let currentUser = JSON.parse(localStorage.getItem("currentUser")) || null;
let posts = JSON.parse(localStorage.getItem("posts")) || [];
let pendingPosts = JSON.parse(localStorage.getItem("pendingPosts")) || [];

// Check if user is signed in
function checkUser() {
    if(currentUser){
        document.getElementById("signinPrompt").classList.add("hidden");
        document.getElementById("postSection").classList.remove("hidden");
    } else {
        document.getElementById("signinPrompt").classList.remove("hidden");
        document.getElementById("postSection").classList.add("hidden");
    }
}

// Submit post (goes to manager for approval)
function submitPost(){
    let text = document.getElementById("postText").value;
    let files = document.getElementById("postImages").files;
    if(!text && files.length === 0){
        alert("Please write something or add images.");
        return;
    }

    // Convert files to Base64 for preview and storage
    let images = [];
    if(files.length > 0){
        for(let i=0; i<files.length; i++){
            let reader = new FileReader();
            reader.onload = function(e){
                images.push(e.target.result);
                if(images.length === files.length){
                    savePendingPost(text, images);
                }
            }
            reader.readAsDataURL(files[i]);
        }
    } else {
        savePendingPost(text, []);
    }
}

// Save post as pending for manager approval
function savePendingPost(text, images){
    let newPost = {
        id: Date.now(),
        user: currentUser.email,
        text: text,
        images: images,
        approved: false
    };
    pendingPosts.push(newPost);
    localStorage.setItem("pendingPosts", JSON.stringify(pendingPosts));
    alert("Your post has been sent for approval. Manager will review it.");
    document.getElementById("postText").value = "";
    document.getElementById("postImages").value = "";
    updateManagerView();
}

// Load posts that are approved
function loadPosts(){
    let container = document.getElementById("postsContainer");
    container.innerHTML = "";
    posts.forEach(p => {
        let div = document.createElement("div");
        div.className = "post";
        div.innerHTML = `<strong>${p.user}</strong><p>${p.text}</p>`;
        p.images.forEach(img => {
            let image = document.createElement("img");
            image.src = img;
            div.appendChild(image);
        });
        container.appendChild(div);
    });
}

// Manager view to approve posts
function updateManagerView(){
    if(!currentUser || currentUser.role !== "manager") return;
    document.getElementById("managerSection").classList.remove("hidden");
    let container = document.getElementById("managerPosts");
    container.innerHTML = "";
    pendingPosts.forEach((p, index) => {
        let div = document.createElement("div");
        div.className = "post";
        div.innerHTML = `<strong>${p.user}</strong><p>${p.text}</p>`;
        p.images.forEach(img => {
            let image = document.createElement("img");
            image.src = img;
            div.appendChild(image);
        });
        let approveBtn = document.createElement("button");
        approveBtn.innerText = "Approve";
        approveBtn.onclick = function(){
            posts.push({...p, approved: true});
            pendingPosts.splice(index, 1);
            localStorage.setItem("posts", JSON.stringify(posts));
            localStorage.setItem("pendingPosts", JSON.stringify(pendingPosts));
            loadPosts();
            updateManagerView();
        }
        div.appendChild(approveBtn);
        container.appendChild(div);
    });
}

// Simulate a user login for demo (replace with real login system)
function demoLogin(){
    if(!currentUser){
        alert("Please Sign In / Sign Up first.");
        return;
    }
    checkUser();
    loadPosts();
    updateManagerView();
}

// Demo initialization
checkUser();
loadPosts();
updateManagerView();

</script>

<a href="/Home-Page.html"><button>Home</button></a>
<a href="/Services we offer.html"><button>Services</button></a>
<a href="/Donate.html"><button>Donate</button></a>
<a href="/Sign In-Sign Up.html"><button>Sign In / Sign Up</button></a>
<a href="/Jobs.html"><button>Jobs</button></a>
<a href="/Volunteer with-Us.html"><button>Volunteer with Us</button></a>
<a href="/Our-Partners.html"><button>Our Partners</button></a>
<a href="/Posting-System.html"><button>Posting System</button></a>
<a href="/Our-Staffs.html"><button>Our Staffs</button></a>
   <a href="/About-Us.html"><button>About-Us</button></a>
   <a href="/Get in Touch with Us.html"><button>Get in Touch with Us</button></a>
   <a href="/contact us.html"><button>Contact Us</button></a>
   <a href="/Subscribe.html"><button>Subscribe</button></a>
   

   <!-- ================= FOOTER ================= -->
<footer class="footer">
  
  <!-- Social Media Row -->
  <div class="footer-social">
    <a href="#" target="_blank"><img src="https://cdn-icons-png.flaticon.com/48/174/174848.png" alt="Facebook"></a>
    <a href="#" target="_blank"><img src="https://cdn-icons-png.flaticon.com/48/174/174855.png" alt="Twitter"></a>
    <a href="#" target="_blank"><img src="https://cdn-icons-png.flaticon.com/48/174/174857.png" alt="Instagram"></a>
    <a href="#" target="_blank"><img src="https://cdn-icons-png.flaticon.com/48/174/174879.png" alt="LinkedIn"></a>
    <a href="#" target="_blank"><img src="https://cdn-icons-png.flaticon.com/48/1384/1384060.png" alt="YouTube"></a>
    <a href="#" target="_blank"><img src="https://cdn-icons-png.flaticon.com/48/3046/3046123.png" alt="TikTok"></a>  </div>

  <!-- Footer Columns -->
  <div class="footer-columns">
    
    <!-- Left Column -->
    <div class="footer-column">
      <h3>About Us</h3>
      <p>Hope of Tomorrow is committed to empowering communities, supporting volunteers, and delivering impactful services for those in need.</p>
    </div>

    <!-- Middle Column -->
    <div class="footer-column">
      <h3>Quick Links</h3>
      <ul>
        <li><a href="/Home-Page.html">Home</a></li>
        <li><a href="/Services we offer.html">Services</a></li>
        <li><a href="/Donate.html">Donate</a></li>
        <li><a href="/Sign In-Sign Up.html">Sign In / Sign Up</a></li>
        <li><a href="/Jobs.html">Jobs</a></li>
        <li><a href="/Volunteer with-Us.html">Volunteer with Us</a></li>
      </ul>
    </div>

    <!-- Right Column -->
    <div class="footer-column">
      <h3>Legal & Support</h3>
      <ul>
        <li><a href="/privacy.html">Privacy Policy</a></li>
        <li><a href="#">Security</a></li>
        <li><a href="#">Terms & Conditions</a></li>
        <li><a href="#">Disclaimer</a></li>
        <li><a href="#">Help Center</a></li>
      </ul>
    </div>

  </div>

  <hr>
  <div class="footer-bottom">
    <p>© <span id="year"></span> Hope of Tomorrow. All Rights Reserved.</p>
  </div>

</footer>

<!-- ================= CSS ================= -->
<script src="assets/js/site.js"></script>


</body>
</html>