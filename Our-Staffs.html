<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Our Staff — Hope of Tomorrow</title>
    <link rel="stylesheet" href="assets/css/styles.css">
  </head>
  <body>
    <header class="site-header">
      <div class="container">
        <a class="brand" href="Home-Page.html"><img src="image/HoT.png" alt="Hope of Tomorrow Logo" class="logo"></a>
        <nav class="site-nav"><a href="Sign In-Sign Up.html">Sign In / Sign Up</a></nav>
      </div>
    </header>

    <main class="container">
      <section class="content-section">
        <h1>Our Staff</h1>

        <form id="addStaffForm" class="form-card">
          <input class="input-full" type="text" id="staffName" placeholder="Full Name" required>
          <input class="input-full" type="text" id="staffPosition" placeholder="Position" required>
          <input class="input-full" type="text" id="staffAddress" placeholder="Address" required>
          <input class="input-full" type="text" id="staffNationality" placeholder="Nationality" required>
          <input class="input-full" type="file" id="staffPhoto" accept="image/*">
          <button class="btn-primary" type="submit">Add Staff</button>
        </form>

        <h2>Active Staffs</h2>
        <table id="activeStaffTable" class="responsive-table">
          <thead>
            <tr>
              <th>Name</th>
              <th>Position</th>
              <th>Address</th>
              <th>Nationality</th>
              <th>Status</th>
              <th>Photo</th>
              <th>Action</th>
              <th>Benefits System</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>

        <h2>Inactive Staffs</h2>
        <table id="inactiveStaffTable" class="responsive-table">
          <thead>
            <tr>
              <th>Name</th>
              <th>Position</th>
              <th>Address</th>
              <th>Nationality</th>
              <th>Status</th>
              <th>Photo</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </section>
    </main>

    <script>
    // Admin simulation
    const currentUser = { role: "admin" };
    let staffList = JSON.parse(localStorage.getItem('staffList')) || [];

    const addForm = document.getElementById('addStaffForm');
    const activeTableBody = document.querySelector('#activeStaffTable tbody');
    const inactiveTableBody = document.querySelector('#inactiveStaffTable tbody');

    addForm.addEventListener('submit', function(e){
      e.preventDefault();
      const staffName = document.getElementById('staffName').value.trim();
      if(staffList.some(s => s.name.toLowerCase() === staffName.toLowerCase())){
        alert("Staff with this name already exists!");
        return;
      }
      const staff = {
        name: staffName,
        position: document.getElementById('staffPosition').value,
        address: document.getElementById('staffAddress').value,
        nationality: document.getElementById('staffNationality').value,
        status: "Active",
        photo: document.getElementById('staffPhoto').files[0] ? URL.createObjectURL(document.getElementById('staffPhoto').files[0]) : ''
      };
      staffList.push(staff);
      saveAndRender();
      addForm.reset();
    });

    function renderTable() {
      activeTableBody.innerHTML = '';
      inactiveTableBody.innerHTML = '';
      staffList.forEach((staff, index) => {
        const row = `
          <td>${staff.name}</td>
          <td>${staff.position}</td>
          <td>${staff.address}</td>
          <td>${staff.nationality}</td>
          <td>${staff.status}</td>
          <td>${staff.photo ? `<img src="${staff.photo}" width="50" height="50" class="avatar" alt="${staff.name}">` : 'No Photo'}</td>
          <td>${currentUser.role === 'admin' ? `<select onchange="updateStatus(${index}, this.value)"><option value=\"Active\" ${staff.status === 'Active' ? 'selected' : ''}>Active</option><option value=\"Inactive\" ${staff.status === 'Inactive' ? 'selected' : ''}>Inactive</option></select>` : '-'}</td>
        `;
        if(staff.status === 'Active') {
          const tr = document.createElement('tr');
          tr.innerHTML = row + `<td><button onclick="accessBenefits(${index})" class="btn-primary">Benefits System</button></td>`;
          activeTableBody.appendChild(tr);
        } else {
          const tr = document.createElement('tr');
          tr.innerHTML = row;
          inactiveTableBody.appendChild(tr);
        }
      });
    }

    function updateStatus(index, newStatus) {
      if(currentUser.role !== 'admin'){ alert("Only admin can update staff status"); return; }
      staffList[index].status = newStatus;
      saveAndRender();
    }

    function accessBenefits(index){
      const staff = staffList[index];
      if(staff.status !== 'Active'){ alert("Your account is inactive. Admin needs to approve access to Benefits System."); return; }
      window.location.href = "BenefiSys.html";
    }

    function saveAndRender(){
      localStorage.setItem('staffList', JSON.stringify(staffList));
      renderTable();
    }

    renderTable();
    </script>

    <footer class="footer">
      <div class="container"><div class="footer-bottom"><p>© <span id="year"></span> Hope of Tomorrow. All Rights Reserved.</p></div></div>
    </footer>

    <script src="assets/js/site.js"></script>
  </body>
</html>